## 문제

URL과 URN에 대한 설명 중, URN이 해결하고자 했으나 널리 사용되지 못했던 URL의 근본적인 문제점은 무엇인가요?

1. URL은 사용자 이름과 비밀번호를 평문으로 노출시켜 보안에 취약하다.
2. URL은 호스트명 확장이나 히스토리 확장이 불가능하여 입력이 불편하다.
3. URL은 UTF-8 인코딩을 지원하지 않아 한글이나 특수 문자를 전송할 수 없다.
4. URL은 리소스의 위치를 기반으로 하므로, 리소스의 위치가 변경되면 해당 URL이 무효화된다.
5. URL은 HTTP 프로토콜만 지원하며, FTP나 Mailto와 같은 다른 스킴을 사용할 수 없다.

---

# 1. HTTP 개관

- 얼마나 많은 클라이언트와 서버가 통신하는지
- 리소스가 어디서 오는지
- 웹 트랜잭션이 어떻게 동작하는지
- HTTP 통신을 위해 사용하는 메시지의 형식
- HTTP 기저의 TCP 네트워크 전송
- 여러 종류의 HTTP 프로토콜
- 인터넷 곳곳에 설치된 다양한 HTTP 구성요소

## 1.1 HTTP: 인터넷의 멀티미디어 배달부

- HTTP 는 신뢰성 있는 데이터 전송 프로토콜을 사용, 데이터의 신뢰성을 보장
- 개발자는 인터넷의 결함이나 약점에 대한 걱정 없이 어플리케이션 고유 기능 개발에 집중이 가능

## 1.2 웹 클라이언트와 서버

- 클라이언트는 서버에게 HTTP 요청을 보내고, 서버는 HTTP 응답으로 돌려 준다

## 1.3 리소스

- 가장 단순한 웹 리소스는 웹 서버 파일 시스템의 정적 파일 (TXT, HTML, 워드, PDF, 이미지, 동영상 등등)
- 요청에 따라 콘텐츠를 생성하는 동적 리소스일 수 있다

### 1.3.1 미디어 타입

- MIME(Multipurpose Internet Mail Extensions)
  - HTTP 로 전송되는 객체의 미디어 타입을 명시하는 라벨
  - 각기 다른 전자 메일 시스템 사이에서 메세지의 타입을 구분하기 위하여 탄생
  - / 으로 구분된 주 타입과 부타입으로 이루어진 문자열 라벨
- 종류
  - HTML : text/html
  - TEXT : text/plain
  - JPEG, GIF : image/jpeg, image/gif
  - 퀵타임 동영상 : video/quicktime
  - PPT : application/vnd.ms-powerpoint
  - 기타 등등

### 1.3.2 URI (Uniform Resource Identifier)

- 웹 서버상의 리소스를 식별할 수 있는 문자열
- 해당 자원이 무엇인가? 에 대한 대답으로 자원의 위치(URL)와 이름(URN)을 포함하는 상위 개념

### 1.3.3 URL (Uniform Resource Locater)

- 웹 서버상의 리소스의 구체적 위치를 서술, URI 의 가장 흔한 형태
- 프로토콜 (http://) / 서버의 인터넷 주소 (www.joes-hardware.com) / 서버의 리소스 (/index.html) 의 구조를 가짐
- `ex) 북아현 두산아파트 xxx동 xxxx호 안에 사는 이효석`

### 1.3.4 URN (Uniform Resource Name)

- 리소스의 위치에 영향을 받지 않는 유일한 이름의 역할
- 프로토콜, 복사의 영향을 받지 않고 지칭하여 사용이 가능
- 단일성과 영속성 보장 및 이름과 실제 자원의 위치를 관리하는 인프라의 부재로 널리 사용은 안되고 있었음
  - 공식 문서 번호 및 도서 분류 번호 등에 제한적으로 사용
- `ex) 85xxxx-xxxxxxx 의 주민번호를 가진 이효석`

> 뜬금이지만 블록 체인을 잘 쓰면 URN 의 단점을 해결 가능하지 않을까요?

## 1.4 트랜잭션

- 클라이언트가 웹 서버와 정보를 주고받는 전체 과정을 의미하며, 연결 수립 / 요청과 응답 / 연결 종료 의 3단계로 구성

### 1.4.1 메서드

- HTTP 요청 메세지에 포함되며, 서버에게 어떤 동작이 취해져야 하는지 알려줌
  - GET : 서버에서 클라이언트로 지정한 리소스를 전송
  - PUT : 클라이언트에서 서버로 보낸 데이터를 지정한 이름의 리소스로 저장
  - DELETE : 지정한 리소스를 서버에서 삭제
  - POST : 클라이언트 데이터를 서버 게이트웨이 어플리케이션으로 전송
  - HEAD : 지정한 리소스에 대한 응답에서 HTTP 헤더만 전송

### 1.4.2 상태 코드

- 응답 상태를 알려주는 코드, 숫자 코드와 사유 구절로 구성 (200 OK)
- 실제 응답 처리에는 숫자 코드가 사용

### 1.4.3 웹페이지는 여러 객체(트랜잭션)로 이러질 수 있다

- 풍부한 웹페이지를 위해서 대량의 HTTP 트랜잭션을 수행
- 레이아웃을 위한 뼈대를 트랜잭션으로 가져온 뒤, 추가 구성 요소를 위한 HTTP 트랜잭션을 수행
- **따라서, 웹페이지는 하나의 리소스가 아닌 리소스의 모음**

## 1.5 메시지

- HTTP 요청, 응답 메시지 2가지만 존재하며, 일반 텍스트로 작성 된 시작줄, 헤더, 본문의 구조로 구성
- 시작 줄 : 메세지의 첫 줄, 요청이면 무엇을 해야하는지 응답이면 무슨 일이 일어났는지를 표현
- 헤더 : 시작 줄 다음에 이어지며, 본문의 해석을 위한 정보를 담는다. 빈 줄을 통해 본문과 구분
- 본문 : 어떤 종류의 데이터도 들어갈 수 있는 부분, 요청과 응답의 실제 데이터를 전달. 이진 데이터(미디어, 응용 소프트웨어) 포함 가능

_ex) 요청 예시_

```http
GET /about.html HTTP/1.1
Host: www.myserver.com
User-Agent: Mozilla/5.0
Accept: text/html
```

_ex) 응답 예시_

```http
HTTP/1.1 200 OK
Date: Mon, 03 Nov 2025 07:45:00 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 150

<!DOCTYPE html>
<html>
<head><title>About</title></head>
<body>
    <h1>Welcome to the About Page!</h1>
</body>
</html>
```

## 1.6 TCP(Transmission Control Protocol) 커넥션

### 1.6.1 TCP/IP

- HTTP 는 어플리케이션 계층 프로토콜로 네트워크에 관한 부분은 TCP 가 담당
- TCP 와 IP 가 층을 이루는 패킷 교환 네트워크 프로토콜의 집합이며 실제 데이터를 전송하는 계층
- TCP 는 오류 없는 데이터 전송 / 순서에 맞는 전달 / 조각 나지 않는 데이터 스트림을 보장

![img.png](./images/01_http_layer.png)

### 1.6.2 접속, 그리고 IP 주소 그리고 포트 번호

- HTTP 통신 수립을 위해서는 인터넷 프로토콜 주소와 포트번호를 사용하여 클라이언트와 서버 사이에 TCP/IP 커넥션 수립이 필요
- URL이 포함하고 있는 IP와 포트 번호를 사용하여 TCP 커넥션을 수립한 뒤, HTTP 메시지를 주고 받음
- 순서
  - 브라우저는 URL 에서 서버의 호스트 명을 추출
  - 브라우저는 서버의 호스트 명을 IP로 변환
  - 브라우저는 URL 에서 포트번호가 있다면 추출
  - 브라우저와 서버가 TCP 커넥션을 수립
  - 브라우저는 서버에 HTTP 요청을 보냄
  - 서버는 브라우저에 HTTP 응답을 보냄
  - 커넥션이 닫히면 브라우저는 문서를 보여줌

### 1.6.3 텔넷(Telnet)을 이용한 실제 예제

- 원격지 호스트에 접속하기 위한 유틸리티, 트래픽이 평문 그대로 전송되어 SSH 로 대체
- 윈도우는 옵션, 리눅스나 mac 에서는 설치 후 이용 가능

## 1.7 프로토콜 버전

- HTTP/0.9 : 1991 년의 프로토타입, GET 메서드만 지원 및 구식 클라이언트만 사용 가능
- HTTP/1.0 : 처음 널리 쓰이기 시작한 버전, 시각적 페이지 / 상호 작용하는 폼이 실현
- HTTP/1.0+ : 1990년 중반 1.0 버전에 keep-alive(최초 요청 이후에도 TCP 연결이 유지되는) 커넥션, 가상 호스팅 지원, 프록시 연결을 추가
- HTTP/1.1 : 현재의 HTTP 버전, HTTP 1.0 버전의 문제점 개선 최적화, 필요 기능이 추가 된 버전
- HTTP/2.0 : 1.1 버전의 성능 개선을 위해 구글의 SPDY 프로토콜을 기반으로 설계

### SPDY 프로토콜

- 멀티 플렉싱 : 하나의 TCP 에서 여러 요청-응답 처리
- 헤더 압축 : 불필요한 헤더 반복 감소
- 바이너리 프레이밍 : 일반 문자열이 아닌 바이너리 인코딩으로 속도 개선
- 우선순위 설정 : 클라이언트가 요청하는 리소스에 우선순위 설정 가능
- 서버 푸쉬 : 클라이언트 요청 없이 필요 리소스를 서버에서 전송 가능
- TLS 필수

## 1.8 웹의 구성 요소

### 1.8.1 프록시

- 주로 보안을 위해 사용 되며, 클라이언트와 서버 사이에 위치하여 모든 HTTP 요청을 받아서 사용자를 대신하여 서버에 접근 및 전달

### 1.8.2 캐시

- 자주 요청되는 문서의 사본을 저장해두는 특별한 종류의 HTTP 프록시 서버로 더 빠른 문서 접근을 가능하게 해준다

### 1.8.3 게이트 웨이

- 다른 서버들의 중개자로 동작하는 서버, 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용
- FTP URI 대한 HTTP 요청을 HTTP/FTP 게이트웨이가 처리하여 FTP 프로토콜을 통해 문서를 가져와서 클라이언트에 전달

![img.png](./images/01_http_http-ftp.png)

### 1.8.4 터널

- 두 커넥션 사이의 RAW 데이터를 보여주지 않고 그대로 전달해주는 HTTP 어플리케이션
- 터널을 통해 암호화된 SSL 트래픽을 웹 트래픽만 허용하는 사내 방화벽을 통과 시킬 수 있음

![img.png](./images/01_http-tunnel.png)

### 1.8.5 에이전트

- 사용자를 위해 임의의 HTTP 요청을 만들어주는 클라이언트 프로그램
- 스파이더나, 웹로봇, 크롤러 등등

# 02. URL 과 리소스

- URL 문법, 여라 URL 컴포넌트가 어떤 의미를 가지며 무엇을 수행하는지
- 여러 웹 클라이언트가 지원하는 상대 URL 과 확장 URL 같은 단축 URL 에 대해서
- URL 의 인코딩과 문자 규칙
- 여러 인터넷 정보 시스템에 적용되는 공통 URL 스킴
- 기존 이름은 유지하면서 객체들을 다른 장소로 옮기는 것을 가능해주는 URN 을 포함한 URL 의 미래

## 2.1 인터넷의 리소스 탐색하기

- URL 은 `스킴(어떻게) / 서버의 위치(어디에) / 리소스의 경로(무엇을)` 로 구성
- `ex) 스킴://서버위치/경로`

### 2.1.1 URL 이 있기 전 암흑의 시대

- URL 이전에는 어플리케이션에 따라 다른 분류 방식을 사용
- URL 이 도입되어 브라우저에게 정보를 찾는데 필요한 정보를 단순화 & 통일 시킴

## 2.2 URL 문법

- URL 의 컴포넌트 구성
  - `<스킴>://<사용자이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>`
- 각 구성별 역할
  - 스킴 : 리소스를 가져오기 위한 프로토콜
  - 사용자 이름 & 비밀번호 : 보안 위험으로 사용 X, ftp 와 같은 스킴에서 데이터 접근을 위해 사용되나 SFTP 또는 전용 프로그램을 통해 노출 되지 않도록 사용 권장
  - 호스트 : 리소스를 호스팅하는 서버의 호스트 명 or IP 주소
  - 포트 : 호스팅 서버의 포트 번호
  - 경로 : 서버에서 리소스가 위치한 곳의 경로
  - 파라미터 : 입력 파라미터로 **리소스의 일부를 형성**, `;`를 기준으로 여러개를 가질 수 있다
    - `ex) http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true`
  - 질의 : 쿼리 스트링으로 **리소스에 대한 추가 정보**를 전달, 어플리케이션에 추가 파라미터를 전달하는 용도
  - 프래그먼트 : 리소스의 조각이나 일부분, URL 이 특정 객체를 지칭하는 경우 서버로 전달 X → 클라이언트에서만 사용
- URL 에서 제일 중요한 컴포넌트는 스킴, 호스트, 경로

## 2.3 단축 URL

### 2.3.1 상대 URL

- `./` 로 기저 URL 을 바탕으로 리소스의 집합을 쉽게 변경 가능한 도구
- 기저 URL 은 HTML 코드에 명시 / 현재 리소스의 주소 / 기저 URL 이 없는 경우(오류 상황) 에 따라 해석이 달라진다

### 2.3.2 URL 확장

#### 호스트명 확장

- 브라우저에서 간단한 휴리스틱을 활용 하여 호스트 명을 완성 하는 경우, 단 어플리케이션에 문제 발생이 가능(6장)
- `ex) yahoo -> www.yahoo.com` 으로 확장

#### 히스토리 확장

- 사용자가 이전에 사용했던 URL 기록을 바탕으로 확장

## 2.4 안전하지 않은 문자

- URL 은 다양한 프로토콜로 전송이 가능하면서도 리소스의 위치가 유실되지 않도록 하기 위한 설계가 적용 + 가독성
- 따라서 SMTP 와 같은 프로토콜로 전송 시 제거되거나 변환되는 문자의 사용은 금지
- 알파벳 이외의 문자 전송시에는 이스케이프를 사용하여 안전하게 인코딩이 가능하도록 설계

### 2.4.1 URL 문자 집합

- 기본적으로 US-ASCII 를 사용, 단 이스케이프 문자열(%)을 사용하여 다른 언어 및 특수 문자 인코딩이 가능

### 2.4.2 인코딩 체계 & 2.4.3 문자 제한-

- URL 문법에 사용되는 예약된 문자는 이스케이프로 반드시 인코딩이 필요
- URL 이스케이프 문자 예시
  - 공백 : 공백은 다음과 같이 인코딩 / `%20`
  - URL 문법에 사용되는 문자(?, &, /, %, ;) : `? -> %3F` / `& -> 26F` / `/ -> %2F` / `% -> %25` / `; -> %3B`
  - 한글 : UTF-8 로 인코딩 / `%EA%B0%80`

### 2.4.4 좀 더 알아보기

## 2.5 스킴의 바다

- http : HyperText Transfer Protocol, 기본 포트는 80 이며 생략 가능
- https : SSL(Secure Sockets Layers) 를 사용하여 HTTP 의 양 끝단을 암호화한 프로토콜
  - SSL(TLS) : HTTP 와 TCP/IP 사이에 보안을 위해 추가된 계층으로 Socket 통신로를 확립하고 해당 Socket 의 암호화 / 인증 / 무결성을 보장
- mailto : 이멜을 위한 프로토콜로 URL 과는 상이한 포맷을 가짐 `ex) mailto:joe@joes-hardware.com`
- ftp : File Transfer Protocol, 웹 서버의 파일 접근 및 전송을 위한 프로토콜
- rtsp, rtspu : Real Time Streaming Protocol, 읽을 수 있는 오디오 / 비디오 식별자. U 는 UDP 프로토콜을 사용하는 케이스
- file : 호스트 기기의 파일에 접근하는 프로토콜
- news : 특정 문서나 뉴스 그룹 접근용 프로토콜, RFC 1036 에 정의 / 단, 리소스의 위치를 충분히 포함하지 않는 특성을 가진다

_ex) HTTP 와 HTTPS 계층도_  
![img.png](./images/02_http_https.png)

## 2.6 미래

- URL 의 경우 리소스 위치가 변경되면 기능을 잃는 문제가 발생, 따라서 URN 의 개념을 도입하려는 표준 작업에 착수
- 해당 문제를 해결하기 위해 PURL(Persistent Uniform Resource Locators) 가 개발, PURL 은 DNS 와 같이 리소스 위치 중개 서버를 두고 리소스를 우회적으로 제공

### 2.6.1 지금이 아니면, 언제?

- 단, URN 으로의 변화를 위해서는 수많은 웹 서비스에 대한 적용이 필요하므로 시간이 걸릴 것으로 예상

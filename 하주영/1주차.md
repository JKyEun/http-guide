# 1장. HTTP 개관

## 1. 1 HTTP: 인터넷의 멀티미디어 배달부

HTTP는 전 세계의 웹 서버로부터 수십억 개의 JPEG 이미지, HTML 페이지, 텍스트 파일, MPEG 동영상, WAV 오디오 파일 등을 웹 브라우저로 옮겨준다.

## 1.2 웹 클라이언트와 서버

웹 서버는 HTTP 프로토콜로 의사소통하기 때문에 보통 'HTTP 서버'라고 불린다.
클라이언트는 서버에게 HTTP 요청을 보내고 서버는 HTTP 응답을 보낸다.
이처럼 HTTP 클라이언트와 HTTP 서버는 월드 와이드 웹의 기본 요소이다.

## 1.3 리소스
웹 서버는 웹 리소스를 관리하고 제공한다. 
정적 파일(텍스트 파일, HTML 파일, 이미지, 동영상 등) 부터 동적인 데이터(요청에 따라 다른 콘텐츠)까지 다양한다. 
웹 게이트웨이, 인터넷 검색엔진 역시 리소스다.

### 1.3.1 미디어 타입
인터넷은 수천 가지의 데이터 타입을 다루기 때문에, HTTP는 웹에서 전송되는 객체 각각에 MIME 타입이라는 라벨을 붙인다.
- MIME (Multipurpose Internet Mail Extensions)은 사선(/)으로 구분된 주 타입과 부 타입으로 나뉜다.
	- text/html : HTML로 작성된 문서
	- text/plain: plain ASCII 텍스트 문서
	- image/jpeg : JPEG 이미지
	- image/gif: GIF 이미지
	- video/quicktime : 애플 퀵타임 동영상
	- application/vnd.ms-powerpont: 마이크로소프트 파워포인트 애플리케이션

### 1.3.2 URI
클라이언트가 요청하려는 서버 리소스 이름을 통합 자원 식별자(URI)라고 한다.
URI는 URL과 URN으로 나뉜다.

### 1.3.3 URL
URL은 서버 리소스에 대한 구체적인 위치를 서술한다.
통상적으로 URI는 URL과 같은 의미로 사용된다.

### 1.3.4 URN
URN은 서버 리소스에 대해, 그 리소스의 위치에 영향 받지 않는 유일무이한 이름 역할을 한다.
따라서 URN은 리소스를 여기저기로 옮기더라도 문제엇이 동작한다. 
- 예를 들어서, urn:ietf:rfc:2141 의 경우
- 인터넷 표준 문서 'RFC 2141'가 어디에 있거나 상관없이(심지어 여러 군대 복사되었더라도) 그것을 지칭하기 위해 사용할 수 있다.

## 1.4 트랜잭션
HTTP 요청과 응답을 반환하는 과정이다.
애플리케이션은 보통 하나의 작업을 처리하기 위해 여러개의 HTTP 트랜잭션을 수행한다.

### 1.4.1 메서드
메서드를 통해 서버가 해야할 동작을 정해줄 수 있다.
- GET: 서버에서 클라이언트로 리소스를 보내라
- PUT: 클라이언트에서 서버로 보낸 데이터를 지정한 이름의 리소스로 저장하라
- DELETE: 저장한 리소스를 서버에서 삭제해라
- POST: 클라이언트 데이터를 서버 게이트웨이 애플리케이션으로 보내라
- HEAD: 저장한 리소스에 대한 응답에서, HTTP 헤더 부분만 보내라

### 1.4.2 상태 코드
모든 HTTP 응답 메시지는 상태 코드, 사유 구절(reson phrase)와 함께 반환한다.
- 200 OK
- 200 Document attached
- 200 Success
- 200 All's cool, dude
HTTP 는 열거된 상태 코드와 사유 구절을 모두 같은 것으로 취급한다.

### 1.4.3 웹페이지는 여러 객체로 이루어질 수 있다.
애플리케이션은 하나의 작업을 처리하기 위해 여러 HTTP 트랜잭션을 수행한다.
예를 들어, 웹 페이지를 가져올 때 대량의 HTTP 트랜잭션을 수행한다.
- 페이지 레이아웃을 서술하는 HTML 뼈대
- 첨부된 이미지
- 그래픽 조각
- 자바 애플릿 등
이와 같이 '웹 페이지'는 보통 하나의 리소스가 아닌 여러 리소스들의 모음이다.

## 1.5 메시지
HTTP 메시지는 줄 단위의 문자열이다. 이진 형식이 아닌 일반 텍스트 형식으로 사람이 읽고 쓰기 쉽다.
웹 클라이언트가 웹 서버로 보낸 메시지를 '요청 메시지', 그 반대를 '응답 메시지'라고 일컫는다.

- 시작줄 : 메시지의 첫 줄로, 요청이라면 무엇을 해야하는지 응답이라면 무슨 일이 일어났는지를 나타낸다.
- 헤더 : 쌍점(:)으로 구분되어있는 하나의 이름과 하나의 값으로 구성된 문자열
- 본문 : 메시지 본문

### 1.5.1 간단한 메시지의 예
- 요청 메시지
```
GET /test/hi-there.txt HTTP/1.0
--------------------------------
Accept: text/*
Accept-Language: en, fr
```
- 응답 메시지
```
HTTP/1.0 200 OK
---------------------------------
Content-type: text/plain
Content-length: 19
----------------------------------
Hi! I'm a message
```

## 1.6 TCP 커넥션
HTTP 메시지는 TCP (Transmission Control Protocol, 전송 제어 프로토콜) 커넥션을 통해 주고받는다.

### 1.6.1 TCP/IP
HTTP는 애플리케이션 계층 프로토콜이다. HTTP는 네트워크 통신의 핵심적인 세부사항에 대해서는 신경 쓰지 않는다. 대신 대중적이고 신뢰성있는 인터넷 전송 프로토콜인 TCP/IP에게 맡긴다.
- 오류 없는 데이터 전송
- 순서를 보장한다.
- 조각나지 않는 데이터 스트림(언제든 어떤 크기로 보낼 수 있다.)

### 1.6.2 접속, IP 주소 그리고 프로토콜
HTTP 클라이언트가 서버에 메시지를 전송하기 위해, IP와 포트번호를 사용해서 서버와 클라이언트 사이에 TCP/IP 커넥션을 맺어야한다.
URL을 통해 IP, 포트번호를 알아낼 수 있다.
1) 웹 브라우저는 서버의 URL에서 호스트 명을 추출한다.
2) 웹 브라우저는 서버의 호스트 명을 IP로 반환한다.
3) 웹 브라우저는 URL에서 포트번호를 추출한다.
4) 웹 브라우저는 웹서버와 TCP 커넥션을 맺는다.
5) 웹 브라우저는 서버에 HTTP 요청을 보낸다.
6) 서버는 웹 브라우저에 HTTP 응답을 돌려준다.
7) 커넥션이 닫히면, 웹 브라우저는 문서를 보여준다.

### 1.6.3 텔넷(Telnet)을 이용한 실제 예제
HTTP는 TCP/IP를 사용하며, 이진 형식이 아닌 문자열 기반이기 때문에 웹 서버와 직접 대화하는 것도 간단하다.
텔넷은 다음과 같은 이유로 사용된다.
- 네트워크 테스트 및 문제 해결: 특정 포트에 대한 연결을 시도하여 서비스가 정상적으로 응답하는지 확인
- 간단하고 리소스가 적은 장치에 대한 원격 접속: 구현이 간단하기 때문에, 리소스가 제한된 장치(예. 임베디드 시스템)을 개발할 때 유일한 원격 접속 방법이 될 수 있다.

## 1.7 프로토콜 버전
- HTTP/0.9 : 오로지 GET 메소드만 지원하고, MIME 타입이나, HTTP 헤더, 버전 번호를 지원하지 않는다.
- HTTP/1.0 : 처음으로 널리 쓰이기 시작한 HTTP 버전이다. 추가 메소드, HTTP 헤더. 멀티미디어 객체 처리르 추가했다. 웹 페이지와 상호작용하는 폼을 실현했고, 이는 월드 와이드 웹을 대세로 만들었다.
- HTTP/1.0 + : 'keep-alive' 커넥션, 가상 호스팅 지원, 프록시 연결 지원 등 포함하였다.
- HTTP/1.1 : 현재의 HTTP 버전
- HTTP/2.0 : HTTP/1.1 성능 문제를 개선하기 위해 구글의 SPDY 프로토콜을 기반으로 설계가 진행 중이다.

## 1.8 웹 구성요소
- 프록시 : 클라이언트와 서버 사이에 위치한 중개자
- 캐시 : 많은 찾는 데이터를 클라이언트 가까이에 보관하는 곳
- 게이트웨이 : 다른 애플리케이션과 연결된 특별한 웹 서버
- 터널 : 단순히 HTTP 통신을 전달하기만 하는 특별한 프록시
- 에이전트 : HTTP 요청을 만드는 웹 클라이언트

### 1.8.1 프록시
서버와 클라이언트 사이에 위치하여, 클라이언트의 모든 HTTP 요청을 받아 특정 일을 수행한 다음 서버에 전달한다.
프록시는 주로 보안을 위해 사용된다. 즉 모든 웹 트래픽 흐름 속에서 신뢰할 만한 중개자 역할을 한다.
또한 요청과 응답을 필터링한다.
예를 들어, 회사에서 무언갈 다운로드 받을 때 바이러스를 검출하거나 어린 학생들에게 성인 콘텐츠를 차단한다.

### 1.8.2 캐시
빈번하게 찾는 문서들의 사본을 저장해 두는 특별한 종류의 HTTP 프록시 서버이다.
멀리 떨어진 웹 서버보다 근처에 캐시를 둠으로써 더 빠르게 데이터를 가져올 수 있게 할 수 잇다.

### 1.8.3 게이트 웨이
게이트 웨이는 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용된다. 게이트웨이는 언제나 스스로가 리소스를 가지고 있는 진짜 서버인것처럼 요청을 다룬다. 즉 클라이언트는 자신이 게이트웨이와 통신하고 있음을 알아채지 못한다.
HTTP/FTP 게이트웨이는 FTP URI에 대한 HTTP 요청을 받아들인 뒤, FTP 프로토콜을 이용해 문서를 가져온다. 받아온 문서는 HTTP 메시지에 담겨 클라이언트에게 보낸다.

### 1.8.4 터널
두 커넥션 사이에서 날(raw) 데이터를 열어보지 않그 그대로 전달해주는 HTTP 애플리케이션이다.
주로 비 HTTP 데이터를 하나 이상의 HTTP 연결을 통해 그대로 전송하기 위해 사용된다.
대표적인 예는 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송함으로써 웹 트래픽만 허용하는 사내 방화벽을 통과시키는 것이있다.
우선 HTTP/SSL 터널은 HTTP 요청을 받아들여 목적지의 주소와 포트번호로 커넥션을 맺고, 그 이후부터는 암호화된 SSL 트래픽을 HTTP 채널을 통해 목적지 서버로 전송할 수 있게 한다.

### 1.8.5 에이전트
HTTP 요청을 만들어주는 클라이언트 프로그램을 '에이전트' 또는 '사용자 에이전트'라고 한다.
웹 요청을 만드는 모든 애플리케이션은 HTTP 에이전트라고 부를 수 있다.
- 클라이언트
- 자동화된 에이전트('스파이더', '웹로봇')

<br/>

# 2장. URL과 리소스

## 2.1 인터넷의 리소스 탐색하기

URL은 브라우저가 정보를 찾는데 필요한 리소스의 위치를 가리키며, URL을 이용해 인터넷상의 리소스를 찾고 사용하며 공유할 수 있다.
예를 들어, http://www.joes-hardware.com/seasonal/index-fall.html
- 스킴 : 가장 첫번째 부분으로, 클라이언트가 리소스에 어떻게 접근하는지
- 서버의 위치(호스트 주소 혹은 아이피) : 리소스가 어디에 호스팅되어있는지
- 경로 : 마지막으로, 요청받은 리소스가 무엇인지

### 2.1.1 URL이 있기 전 암흑의 시대
오늘날 친구에게 브라우저에서 'ft://fpt.lots-o-books.com/pub/complete-catalog.xls를 열어봐' 라고 말한다.
과거에는 이 간단한 URL을 말로 풀어서 설명했어야 했는데,
- 'ftp.joes-hardware.com'에 ftp로 접속해라
- 익명 사용자로 로그인해서 다음 비밀번호로 네 이름을 입력해
- pub 디렉토리로 이동해서
- 바이너리 형식으로 전화하고
- complete-catalog.xls란 이름의 파일을 너의 로컬 파일 시스템에 내려 받으면 돼

이처럼 URL은 브라우저에게 정보를 찾는데 필요한 모든 정보 (어디에 위치하는지, 어떻게 가져오는지)를 정의한다.

## 2.2 URL 문법
URL로 인터넷 상의 모든 리소스를 찾을 수 있지만, 그 리소스들은 다른 스킴을 통해 접근할 수 있으며, URL 문법은 스킴에 따라서 달라진다.
하지만 대부분의 URL 스킴의 문법은 9가지로 나뉜다.
- 스킴 : 리소스를 가져오기 위해 어떤 프로토콜을 사용하여 서버에 접근해야하는지
- 사용자 이름 : 몇몇 스킴은 리소스에 접근하기 위해 사용자의 이름이 필요하다. (기본값 : anonymous)
- 비밀번호 : 사용자의 비밀번호를 가리키며, 사용자 이름에 콜론(:)으로 이어서 기술 (기본값: 이메일 주소)
- 호스트 : 서버 호스트명이나 IP 주소
- 포트 : 리소스를 호스팅하는 서버가 열어놓은 포트번호 (기본값 : 스킴에 따라 다름)
- 경로 : 빗금(/)으로 구분되어있으며, 서버 내 리소스가 서버의 어디에 위치해 있는지를 가리킨다.
- 파라미터 : 특정 스킴들에서 입력 파라미터를 기술하는 용도이다. 파라미터는 이름/값을 쌍으로 가지며, 다른 파라미터나 경로의 일부와 세미콜론(;)으로 구분하여 기술한다.
- 질의 : 애플리케이션(데이터베이스, 게시판, 검색엔진, 기타 인터넷 게이트웨이)에 파라미터를 전달하는 데 쓰인다. URL 끝에 '?'로 구분한다.
- 프래그먼트 : 리소스 조각이나 일부분을 일으키는 이름이다.